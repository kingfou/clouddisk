<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bootstrap Dashboard</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="/vendor/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="/vendor/font-awesome/css/font-awesome.min.css">
    <!-- Fontastic Custom icon font-->
    <link rel="stylesheet" href="/css/fontastic.css">
    <script src="/js/jquery-2.1.4.min.js"></script>
    <!-- Google fonts - Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
    <!-- jQuery Circle-->
    <link rel="stylesheet" href="/css/grasp_mobile_progress_circle-1.0.0.min.css">
    <!-- Custom Scrollbar-->
    <link rel="stylesheet" href="/vendor/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.css">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="/css/style.default.css" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="/css/custom.css">
    <!-- Favicon-->
    <link rel="shortcut icon" href="/img/favicon.ico">
    <style type="text/css">
        table {
            border: 0;
            border-collapse: collapse;
        }

        td {
            padding: 2px;
        }

        th {
            padding: 4px;
        }

        .selected {
            background: rgb(107, 128, 221);
            color: #fff;
        }
    </style>

    <script type="text/javascript">
        $(function () {
            $('tbody>tr').click(function () {
                var hasSelected = $(this).hasClass('selected');
                $(this)[hasSelected ? "removeClass" : "addClass"]('selected').find(':checkbox').attr('checked', !hasSelected)
            });
            $('tbody>tr:has(:checked)').addClass('selected');

        })
    </script>
    <script>
        $(function () {
            $('.popover-show').popover('show');
        });
        $(function () {
            $('.popover-hide').popover('hide');
        });
        $(function () {
            $('.popover-destroy').popover('destroy');
        });
        $(function () {
            $('.popover-toggle').popover('toggle');
        });
        $(function () {
            $(".popover-options a").popover({html: true});
        });
    </script>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<!-- Side Navbar -->
<nav class="side-navbar">
    <div class="side-navbar-wrapper">
        <!-- Sidebar Header    -->
        <div class="sidenav-header d-flex align-items-center justify-content-center">
            <!-- User Info-->
            <div class="sidenav-header-inner text-center"><img src="/img/avatar-7.jpg" alt="person"
                                                               class="img-fluid rounded-circle">
                <h2 class="h5">Nathan Andrews</h2><span>Web Developer</span>
            </div>
            <!-- Small Brand information, appears on minimized sidebar-->
            <div class="sidenav-header-logo"><a href="/home/showfolders" class="brand-small text-center">
                <strong>B</strong><strong class="text-primary">D</strong></a></div>
        </div>
        <!-- Sidebar Navigation Menus-->
        <div class="main-menu">
            <h5 class="sidenav-heading">Main</h5>
            <ul id="side-main-menu" class="side-menu list-unstyled">
                <li><a href="#exampledropdownDropdown" aria-expanded="false" data-toggle="collapse">
                    <i class="icon-interface-windows"></i>我的云端硬盘 </a>
                    <ul id="exampledropdownDropdown" class="collapse list-unstyled ">
                        <%
                        for(folder in allfolders){
                        %>
                        <li><a href="/home/showfolders?path=/${folder.name}/">${folder.name}</a></li>
                        <%
                        }
                        %>
                    </ul>
                </li>
                <li><a href="index.html"> <i class="icon-picture"></i>共享</a></li>
                <li><a href="index.html"> <i class="icon-form"></i>已删除文件 </a></li>

            </ul>
        </div>

    </div>
</nav>
<div class="page">
    <!-- navbar-->
    <header class="header">
        <nav class="navbar">
            <div class="container-fluid">
                <div class="navbar-holder d-flex align-items-center justify-content-between">
                    <div class="navbar-header"><a id="toggle-btn" href="#" class="menu-btn"><i
                            class="icon-bars"> </i></a><a href="/home/showfolders" class="navbar-brand">
                        <div class="brand-text d-none d-md-inline-block"><span>Drive </span><strong
                                class="text-primary">Dashboard</strong></div>
                    </a></div>
                    <ul class="nav-menu list-unstyled d-flex flex-md-row align-items-md-center">

                        <li class="nav-item"><a href="/home/logOut" class="nav-link logout"> <span
                                class="d-none d-sm-inline-block">Logout</span><i class="fa fa-sign-out"></i></a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>


    <div class="breadcrumb-holder">


        <div class="container-fluid">

            <ul class="breadcrumb">
                <!-- <li class="breadcrumb-item "><a href="index.html">我的云端硬盘</a></li> -->
                <li class="breadcrumb-item  dropdown "><a id="languages" rel="nofollow" data-target="#" href="#"
                                                          data-toggle="dropdown" aria-haspopup="true"
                                                          aria-expanded="false" class="language dropdown-toggle">
                    我的云端硬盘
                </a>
                    <ul aria-labelledby="languages" class="dropdown-menu">
                        <input type="text" value="" width="100" style="display: None;"/>
                        <li><a rel="nofollow" href="#" class="dropdown-item " data-toggle="modal"
                               data-target="#uploadFile"> <span>上传文件</span></a></li>
                        <li><a rel="nofollow" href="#" class="dropdown-item " data-toggle="modal"
                               data-target="#createFold"> <span>新建文件夹</span></a></li>
                    </ul>
                </li>


            </ul>

        </div>
    </div>
    <section>
        <div class="container-fluid">
            <!-- Page Header-->
            <div class="row">
                <table class="table" cellspacing=0 width=100%>
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>名称</th>
                        <th>最后修改时间</th>
                        <th>大小</th>
                        <th>下载</th>
                        <th>删除</th>
                    </tr>
                    </thead>
                    <tbody>

                    <!--- 内容展示 -->
                    <%
                    for(folder in allfolders){
                    %>
                    <tr>
                        <th scope="row"><input type="checkbox"/></th>
                        <td><a href="/home/showfolders?path=${prefix}${folder.name}/">${folder.name}</a></td>
                        <td>${folder.uploaddate}</td>
                        <td>${folder.size}</td>
                        <td><input type="button" value="down" disabled="disabled"/></td>
                        <td>
                            <!--<form action="/home/deleteFolder" >-->
                                <!--<input type="" name="foldName" value="${folder.name}"/>-->
                                <!--<input type="" name="prefix" value="${prefix}"/>-->
                                <!--&lt;!&ndash;<input type="submit" value="Del"/>&ndash;&gt;-->
                                <!---->
                            <!--</form>-->
                            <a  href="#"  data-toggle="modal"
                                   data-target="#delFolder" onclick="udpate_modal('${folder.name}','${prefix}')"> <button>Del</button></a>
                        </td>
                    </tr>
                    <%
                    }
                    %>

                    <!--无目录文件-->
                    <%
                    for(file in noInFoldFiles){
                    %>
                    <tr>
                        <th scope="row"><input type="checkbox"/></th>
                        <td>${file.name}</td>
                        <td>${file.uploaddate}</td>
                        <td>${file.size/1000} Kb</td>
                        <td>

                            <form method="post" action="/home/downloadFile">
                                <input value="${prefix}${file.name}" name="path" type="hidden"/>
                                <input value="${file.name}" name="filename" type="hidden"/>
                                <input  type="submit" value="down" />
                            </form>
                        </td>
                        <td>
                            <!--<form method="post" action="/home/deleteFile">-->
                                <!--<input value="${prefix}" name="prefix" type="hidden"/>-->
                                <!--<input value="${file.name}" name="fileName" type="hidden"/>-->
                                <!--<input  type="submit" value="Del" />-->
                            <!--</form>-->
                            <a  href="#"  data-toggle="modal"
                                data-target="#delFile" onclick="udpate_modal_file('${file.name}','${prefix}')"> <button>Del</button></a>
                        </td>
                    </tr>
                    <%
                    }
                    %>
                    </tbody>
                </table>
            </div>


        </div>
        <div class="mx-auto bg-warning" style="width:200px">
            <ul class="pagination" id="pagination">
            </ul>
        </div>
    </section>


    <div class="modal fade" id="uploadFold" tabindex="-1" role="dialog" aria-labelledby="uploadFoldLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                      &times;
                    </button> -->
                    <h4 class="modal-title" id="uploadFoldLabel">
                        上传文件夹
                    </h4>
                </div>
                <div class="modal-body">
                    <!-- <form id="upload-form" action="#" method="post" enctype="multipart/form-data" >
                      　　　<input type="file" id="upload" name="upload" />
                    </form> -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                    </button>
                    <button type="button" class="btn btn-primary">
                        上传
                    </button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <div class="modal fade" id="uploadFile" tabindex="-1" role="dialog" aria-labelledby="uploadFileLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                      &times;
                    </button> -->
                    <h4 class="modal-title" id="UploadFileLabel">
                        上传文件
                    </h4>
                </div>
                <form id="uploadFile-form" action="/home/uploadfile" method="post" enctype="multipart/form-data">

                    <div class="modal-body">


                            <input type="file" id="upload" name="uploadfile"/>
                            <input type="hidden" name="userId" value=${user.userId}>
                            <input type="hidden" name="prefix" value=${prefix}>


                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">
                            关闭
                        </button>
                        <input type="submit" value="上传" class="btn btn-default">

                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>
    <!--delete folder modal-->
    <div class="modal fade" id="delFolder" tabindex="-1" role="dialog" aria-labelledby="delFolderLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                      &times;
                    </button> -->
                    <h4 class="modal-title" id="delFolderLabel">
                        删除文件夹
                    </h4>
                </div>
                <form id="upload-form" action="/home/deleteFolder" method="post" enctype="multipart/form-data">

                    <div class="modal-body">

                        <input type="text" style="display: none" id ="modaldel"  name="foldName" /> <br>
                        <input type="text"  style="display: none" id="modalprefix" name="prefix"/>
                        是否要删除该文件夹(文件夹下的内容也会被删除)？
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">
                            关闭
                        </button>
                        <input class="btn btn-primary" type="submit" value="删除">

                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>
    <!--delete file modal-->
    <div class="modal fade" id="delFile" tabindex="-1" role="dialog" aria-labelledby="delFileLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                      &times;
                    </button> -->
                    <h4 class="modal-title" id="delFileLabel">
                        删除文件
                    </h4>
                </div>
                <form id="upload-form" action="/home/deleteFile" method="post" enctype="multipart/form-data">

                    <div class="modal-body">

                        <input type="text" style="display: none" id ="modalfiledel"  name="fileName" /> <br>
                        <input type="text" style="display: none" id="modalfileprefix" name="prefix"/>
                        是否要删除该文件？
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">
                            关闭
                        </button>
                        <input class="btn btn-primary" type="submit" value="删除">

                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>


    <div class="modal fade" id="createFold" tabindex="-1" role="dialog" aria-labelledby="createFoldLable"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                      &times;
                    </button> -->
                    <h4 class="modal-title" id="createFoldLable">
                        新建文件夹
                    </h4>
                </div>
                <form id="upload-Fold" action="/home/createFolder" method="post" enctype="multipart/form-data">

                    <div class="modal-body">
                        　　输入文件夹名字：　<input id="foldName" name="foldName"/>
                        　　                   <input id="prefix" name="prefix" value="${prefix}" type="hidden"/>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                        </button>

                        <input class="btn btn-primary" type="submit" value="提交"/>
                    </div>
                </form>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>


    <footer class="main-footer">

        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-6">
                    <p>Bootstrapious All rights reserved. &copy; 2017-2019</p>
                </div>
                <div class="col-sm-6 text-right">
                </div>
            </div>
        </div>


    </footer>
</div>

<!--
modal trans value
-->
<script>
    function udpate_modal(folder_name, prefix) {
        $("#modaldel").val(folder_name);
        $("#modalprefix").val(prefix);
    }
    function udpate_modal_file(file_name, prefix) {
        $("#modalfiledel").val(file_name);
        $("#modalfileprefix").val(prefix);
    }
</script>
<!--
pagination
-->
<script>
    $(function () {
        window.pagObj = $('#pagination').twbsPagination({
            totalPages: 2,
            visiblePages: 1,
            startPage: 1,
            onPageClick: function (event, page) {

            }
        }).on('page', function (event, page) {

        });
    });
</script>

<!-- JavaScript files-->
<script src="/vendor/jquery/jquery.min.js"></script>
<script src="/vendor/popper.js/umd/popper.min.js"></script>

<!-- add new js -->
<script src="/js/jquery.twbsPagination.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>
<script src="/js/jquery.twbsPagination.js" type="text/javascript"></script>
<script src="/js/grasp_mobile_progress_circle-1.0.0.min.js"></script>
<script src="/vendor/jquery.cookie/jquery.cookie.js"></script>
<script src="/vendor/chart.js/Chart.min.js"></script>
<script src="/vendor/jquery-validation/jquery.validate.min.js"></script>
<script src="/vendor/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="/js/charts-home.js"></script>
<!-- Main File-->
<script src="/js/front.js"></script>
</body>
</html>